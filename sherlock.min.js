/*!
 * Sherlock
 * Copyright (c) 2014 Tabule, Inc.
 * Version 1.3.3
 */
var Sherlock=function(){var e={rangeSplitters:/(\bto\b|\-|\b(?:un)?till?\b|\bthrough\b|\bthru\b|\band\b|\bends?\b)/g,months:"\\b(jan(?:uary)?|feb(?:ruary)?|mar(?:ch)?|apr(?:il)?|may|jun(?:e)?|jul(?:y)?|aug(?:ust)?|sep(?:tember)?|oct(?:ober)?|nov(?:ember)?|dec(?:ember)?)\\b",days:"\\b(?:(?:(?:on )?the )(?=\\d\\d?(?:st|nd|rd|th)))?([1-2]\\d|3[0-1]|0?[1-9])(?:st|nd|rd|th)?(?:,|\\b)",years:"\\b(20\\d{2}|\\d{2}[6-9]\\d)\\b",shortForm:/\b(0?[1-9]|1[0-2])\/([1-2]\d|3[0-1]|0?[1-9])\/?(\d{2,4})?\b/,weekdays:/(?:(next|last) (?:week (?:on )?)?)?\b(sun|mon|tue(?:s)?|wed(?:nes)?|thurs|fri|sat(?:ur)?)(?:day)?\b/,relativeDateStr:"((?:next|last|this) (?:week|month|year)|tom(?:orrow)?|tod(?:ay)?|now|day after tom(?:orrow)?|yesterday|day before yesterday)",inRelativeDateStr:"(\\d{1,4}|a) (day|week|month|year)s? ?(ago|old)?",inRelativeTime:/\b(\d{1,2} ?|a |an )(h(?:our)?|m(?:in(?:ute)?)?)s? ?(ago|old)?\b/,inMilliTime:/\b(\d+) ?(s(?:ec(?:ond)?)?|ms|millisecond)s? ?(ago|old)?\b/,midtime:/(?:@ ?)?\b(?:at )?(noon|midnight)\b/,internationalTime:/\b(?:(0[0-9]|1[3-9]|2[0-3]):?([0-5]\d))\b/,explicitTime:/(?:@ ?)?\b(?:at |from )?([0-2]?[1-9])(?::?([0-5]\d))? ?([ap]\.?m?\.?)?(?:o'clock)?\b/,more_than_comparator:/((?:more|greater|newer) than|after)/i,less_than_comparator:/((?:less|fewer|older) than|before)/i,fillerWords:/ (from|is|was|at|on|for|in|due(?! date)|(?:un)?till?)\b/,fillerWords2:/ (was|is|due(?! date))\b/},t=null,a=function(){return t?new Date(t.getTime()):new Date},r=function(e){return"undefined"!=typeof Watson&&Watson.config?Watson.config[e]:null},n=function(e,t,a){var r={},n=!1,i=!1,u=o.strToNum(e);return(n=l(u,t,a))&&(u=u.replace(new RegExp(n),""),e=e.replace(new RegExp(o.numToStr(n)),"")),(i=s(u,t,a))&&(e=e.replace(new RegExp(o.numToStr(i)),"")),r.eventTitle=e,r.isAllDay=!(!n||i||"now"===n),r.isValidDate=!(!n&&!i),r},s=function(t,a,r){var n,s,l,i,o=0,u=!1;if(n=t.match(new RegExp(e.explicitTime.source,"g")))if(n=n.sort(function(e,t){var a=e.trim().length,r=t.trim().length;return e.match(/(?:a|p).?m.?/)&&(a+=20),t.match(/(?:a|p).?m.?/)&&(r+=20),r-a})[0].trim(),n.length<=2&&t.trim().length>2)o=0;else{o=n.length,n=n.match(e.explicitTime);var h=parseInt(n[1]),g=n[2]||0,c=n[3];c?(0===c.indexOf("p")&&12!=h?h+=12:0===c.indexOf("a")&&12==h&&(h=0),o+=20):12>h&&(7>h||h<a.getHours())&&(h+=12),s=h,l=g,i=!!c,u=n[0]}var d=function(){return u&&(a.setHours(s,l,0),a.hasMeridian=i),u};if(!(4>o))return d();if(n=t.match(e.inRelativeTime))switch(isNaN(n[1])&&(n[1]=1),n[3]&&(n[1]=-1*parseInt(n[1])),n[2].substring(0,1)){case"h":return a.setHours(a.getHours()+parseInt(n[1])),n[0];case"m":return a.setMinutes(a.getMinutes()+parseInt(n[1])),n[0];default:return d()}else if(n=t.match(e.inMilliTime))switch(n[3]&&(n[1]=-1*parseInt(n[1])),n[2].substring(0,1)){case"s":return a.setSeconds(a.getSeconds()+parseInt(n[1])),n[0];case"m":return a.setMilliseconds(a.getMilliseconds()+parseInt(n[1])),n[0];default:return d()}else{if(!(n=t.match(e.midtime)))return(n=t.match(e.internationalTime))?(a.setHours(n[1],n[2],0),a.hasMeridian=!0,n[0]):d();switch(n[1]){case"noon":return a.setHours(12,0,0),a.hasMeridian=!0,n[0];case"midnight":return a.setHours(0,0,0),a.hasMeridian=!0,n[0];default:return d()}}},l=function(t,a,r){var n;if(n=t.match(e.monthDay))return n[3]?(a.setFullYear(n[3],o.changeMonth(n[1]),n[2]),a.hasYear=!0):a.setMonth(o.changeMonth(n[1]),n[2]),n[0];if(n=t.match(e.dayMonth))return n[3]?(a.setFullYear(n[3],o.changeMonth(n[2]),n[1]),a.hasYear=!0):a.setMonth(o.changeMonth(n[2]),n[1]),n[0];if(n=t.match(e.shortForm)){var s=n[3],l=null;return s&&(l=parseInt(s)),l&&s.length<4&&(l+=l>50?1900:2e3),l?(a.setFullYear(l,n[1]-1,n[2]),a.hasYear=!0):a.setMonth(n[1]-1,n[2]),n[0]}if(!(n=t.match(e.weekdays))){if(n=t.match(e.inRelativeDateFromRelativeDate))return o.relativeDateMatcher(n[4],a)&&o.inRelativeDateMatcher(n[1],n[2],n[3],a)?n[0]:!1;if(n=t.match(e.relativeDate))return o.relativeDateMatcher(n[1],a)?n[0]:!1;if(n=t.match(e.inRelativeDate))return o.inRelativeDateMatcher(n[1],n[2],n[3],a)?n[0]:!1;if(n=t.match(new RegExp(e.days,"g"))){if(n=n.sort(function(e,t){return t.trim().length-e.trim().length})[0].trim(),0!==n.indexOf("on")&&(0!==n.indexOf("the")||-1===n.indexOf(",",n.length-1))&&-1===t.indexOf(n,t.length-n.length-1)||(!r||!r.isAllDay)&&n.length<=2)return!1;n=n.match(e.daysOnly);var i=a.getMonth(),u=n[1];return u<a.getDate()&&i++,a.setMonth(i,u),n[0]}return!1}switch(n[2].substr(0,3)){case"sun":return o.changeDay(a,0,n[1]),n[0];case"mon":return o.changeDay(a,1,n[1]),n[0];case"tue":return o.changeDay(a,2,n[1]),n[0];case"wed":return o.changeDay(a,3,n[1]),n[0];case"thu":return o.changeDay(a,4,n[1]),n[0];case"fri":return o.changeDay(a,5,n[1]),n[0];case"sat":return o.changeDay(a,6,n[1]),n[0];default:return!1}},i=function(t,r,n,s,l){var i=a();r?t>r&&r>i&&o.isSameDay(t,r)&&o.isSameDay(t,i)?t.hasMeridian?t.setDate(t.getDate()-1):(t.setHours(t.getHours()-12),t>r&&t.setHours(t.getHours()-12)):t>r?r.setDate(t.getDate()+1):i>r&&-1===s.indexOf(" was ")&&o.monthDiff(r,i)>=3&&!r.hasYear&&!t.hasYear&&(r.setFullYear(r.getFullYear()+1),t.setFullYear(t.getFullYear()+1)):t&&(i>t&&o.monthDiff(t,i)>=3&&!t.hasYear&&-1===s.indexOf(" was ")?t.setFullYear(t.getFullYear()+1):l.eventTitle.match(e.more_than_comparator)?(s.match(/(ago|old)/i)&&null===l.eventTitle.match(/(ago|old)/i)?(l.endDate=new Date(t.getTime()),l.startDate=new Date(1900,0,1,0,0,0,0)):l.endDate=new Date(3e3,0,1,0,0,0,0),l.eventTitle=l.eventTitle.replace(e.more_than_comparator,"")):l.eventTitle.match(e.less_than_comparator)&&(s.match(/(ago|old)/i)&&null===l.eventTitle.match(/(ago|old)/i)?l.endDate=new Date(3e3,0,1,0,0,0,0):(l.endDate=new Date(t.getTime()),l.startDate=new Date(1900,0,1,0,0,0,0)),l.eventTitle=l.eventTitle.replace(e.less_than_comparator,"")))},o={relativeDateMatcher:function(e,t){var r=a();switch(e){case"next week":return t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()+7),t.hasYear=!0,!0;case"next month":return t.setFullYear(r.getFullYear(),r.getMonth()+1,r.getDate()),t.hasYear=!0,!0;case"next year":return t.setFullYear(r.getFullYear()+1,r.getMonth(),r.getDate()),t.hasYear=!0,!0;case"last week":return t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()-7),t.hasYear=!0,!0;case"last month":return t.setFullYear(r.getFullYear(),r.getMonth()-1,r.getDate()),t.hasYear=!0,!0;case"last year":return t.setFullYear(r.getFullYear()-1,r.getMonth(),r.getDate()),t.hasYear=!0,!0;case"this week":return t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()),t.hasYear=!0,!0;case"this month":return t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()),t.hasYear=!0,!0;case"this year":return t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()),t.hasYear=!0,!0;case"tom":return t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()+1),t.hasYear=!0,!0;case"tomorrow":return t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()+1),t.hasYear=!0,!0;case"day after tomorrow":return t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()+2),t.hasYear=!0,!0;case"day after tom":return t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()+2),t.hasYear=!0,!0;case"today":return t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()),t.hasYear=!0,!0;case"tod":return t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()),t.hasYear=!0,!0;case"now":return t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()),t.setHours(r.getHours(),r.getMinutes(),r.getSeconds(),0),t.hasMeridian=!0,t.hasYear=!0,!0;case"yesterday":return t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()-1),t.hasYear=!0,!0;case"day before yesterday":return t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()-2),t.hasYear=!0,!0;default:return!1}},inRelativeDateMatcher:function(e,t,a,r){switch(e=isNaN(e)?1:parseInt(e),a&&(e=-1*e),t){case"day":return r.setDate(r.getDate()+e),r.hasYear=!0,!0;case"week":return r.setDate(r.getDate()+7*e),r.hasYear=!0,!0;case"month":return r.setMonth(r.getMonth()+e),r.hasYear=!0,!0;case"year":return r.setFullYear(r.getFullYear()+e),r.hasYear=!0,!0;default:return!1}},changeMonth:function(e){return this.monthToInt[e.substr(0,3)]},changeDay:function(e,t,a){var r=7-e.getDay()+t;r>7&&void 0===a&&(r-=7),"last"===a&&(r=-1*r),e.setDate(e.getDate()+r)},monthDiff:function(e,t){var a;return a=12*(t.getFullYear()-e.getFullYear()),a-=e.getMonth()+1,a+=t.getMonth()+1,0>=a?0:a},escapeRegExp:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isSameDay:function(e,t){return e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()&&e.getFullYear()===t.getFullYear()},monthToInt:{jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11},wordsToInt:{one:1,first:1,two:2,second:2,three:3,third:3,four:4,fourth:4,five:5,fifth:5,six:6,sixth:6,seven:7,seventh:7,eight:8,eighth:8,nine:9,ninth:9,ten:10,tenth:10},intToWords:["one|first","two|second","three|third","four|fourth","five|fifth","six|sixth","seven|seventh","eight|eighth","nine|ninth","ten|tenth"],strToNum:function(t){return t.replace(e.digit,function(e){var t=o.wordsToInt[e];return-1!==e.indexOf("th",e.length-2)?t+="th":-1!==e.indexOf("st",e.length-2)?t+="st":-1!==e.indexOf("nd",e.length-2)?t+="nd":-1!==e.indexOf("rd",e.length-2)&&(t+="rd"),t})},numToStr:function(e){return e.replace(/((?:[1-9]|10)(?:st|nd|rd|th)?)/g,function(e){return"(?:"+e+"|"+o.intToWords[parseInt(e)-1]+")"})}};return e.monthDay=new RegExp(e.months+" "+e.days+"(?: "+e.years+")?"),e.dayMonth=new RegExp(e.days+"(?: (?:day )?of)? "+e.months+"(?: "+e.years+")?"),e.daysOnly=new RegExp(e.days),e.digit=new RegExp("\\b("+o.intToWords.join("|")+")\\b","g"),e.relativeDate=new RegExp("\\b"+e.relativeDateStr+"\\b"),e.inRelativeDate=new RegExp("\\b"+e.inRelativeDateStr+"\\b"),e.inRelativeDateFromRelativeDate=new RegExp("\\b"+e.inRelativeDateStr+" from "+e.relativeDateStr+"\\b"),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),{parse:function(t){null===t&&(t="");var s=a(),l="undefined"!=typeof Watson?Watson.preprocess(t):[t,{}],t=l[0],u=l[1],h=r("disableRanges")?[t.toLowerCase()]:t.toLowerCase().split(e.rangeSplitters);for(e.rangeSplitters.lastIndex=0,s.setMilliseconds(0);!u.startDate&&(null!==(l=n(h[0],s,null))&&(l.isAllDay&&s.setHours(0,0,0),u.isAllDay=l.isAllDay,u.eventTitle=l.eventTitle,u.startDate=l.isValidDate?s:null),!u.startDate&&h.length>=3);){for(var g=[h[0]+h[1]+h[2]],c=3;c<h.length;c++)g.push(h[c]);h=g}for(;!u.endDate;)if(h.length>1&&(s=new Date(s.getTime()),null!==(l=n(h[2],s,u))&&(u.isAllDay&&s.setHours(0,0,0),l.eventTitle.length>u.eventTitle.length&&(u.eventTitle=l.eventTitle),u.endDate=l.isValidDate?s:null)),!u.endDate){if(!(h.length>=4)){u.endDate=null;break}for(var g=[h[0],h[1],h[2]+h[3]+h[4]],c=5;c<h.length;c++)g.push(h[c]);h=g}if(i(u.startDate,u.endDate,u.isAllDay,t,u),u.eventTitle){var d=r("disableRanges")?e.fillerWords2:e.fillerWords;u.eventTitle=u.eventTitle.split(d)[0].trim(),u.eventTitle=u.eventTitle.replace(/(?:^| )(?:\.|-$|by$|in$|at$|from$|on$|starts?$|for$|(?:un)?till?$|!|,|;)+/g,"").replace(/ +/g," ").trim();var m=t.match(new RegExp(o.escapeRegExp(u.eventTitle),"i"));m&&(u.eventTitle=m[0].replace(/ +/g," ").trim(),""==u.eventTitle&&(u.eventTitle=null))}else u.eventTitle=null;return"undefined"!=typeof Watson&&Watson.postprocess(u),u},_setNow:function(e){t=e}}}();"function"==typeof define&&define.amd?define(Sherlock):"undefined"!=typeof module&&module.exports&&(module.exports=Sherlock);